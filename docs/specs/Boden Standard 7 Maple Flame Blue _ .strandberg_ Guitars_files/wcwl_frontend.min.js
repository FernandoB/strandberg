jQuery(document).ready(function(n){function e(){if(n("div.product-type-subscription").length&&!n(".wcwl_email").length&&n("div.wcwl_email_field").append('<input type="email" name="wcwl_email" class="wcwl_email" />'),n(".product-type-grouped").length||n(".single-tribe_events").length){var e=n(".woocommerce.tribe-tickets-form-row");if(0<e.length){var l=!1;n.each(e,function(e,t){var c=n(t).data("product-id"),i=wcwl_event_data.tickets[c];0<i.length&&(l=!0),n(i).insertAfter(n(t).find(".tickets_nostock"))}),l&&(n(wcwl_event_data.button).insertAfter(n(".tribe-events-tickets")),n(".wcwl_frontend_wrap").show()),w()}var t=n("input:checkbox:checked.wcwl_checkbox").map(function(){return n(this).attr("id").replace("wcwl_checked_","")}).get();if(0<!n(".wcwl_email").length)var c=n("input:checkbox:not(:checked).wcwl_checkbox").map(function(){return n(this).attr("id").replace("wcwl_checked_","")}).get();else c=[];n(".wcwl_checkbox").change(function(){var e=n(this).attr("id").replace("wcwl_checked_","");this.checked&&(0<!n(".wcwl_email").length&&c.splice(n.inArray(e,c),1),t.push(e)),this.checked||(t.splice(n.inArray(e,t),1),0<!n(".wcwl_email").length&&c.push(e))});var i=n("a.woocommerce_waitlist").attr("href");n("a.woocommerce_waitlist").on("click",function(e){n(this).prop("href",i+"&wcwl_leave="+c+"&wcwl_join="+t)})}n("form.variations_form").change(function(){w()}),w(),n("li.product").on("click",".wcwl_toggle_email",function(e){e.preventDefault(),n(".wcwl_frontend_wrap").hide(),n(".wcwl_toggle_email").show(),n('input[name="wcwl_email"], .wcwl_optin').removeClass("wcwl_error_highlight"),n(this).hide(),0===n(".logged-in").length&&(n(this).prev(".wcwl_frontend_wrap").prepend(n(".wcwl_email_elements")),n(".wcwl_email_elements").show()),n(this).prev(".wcwl_frontend_wrap").show(),n(this).prev(".wcwl_frontend_wrap").find('input[name="wcwl_email"]').focus()}),n(".wcwl_email_elements").on("keyup keypress","input.wcwl_email",function(e){13===(e.keyCode||e.which)&&n(this).closest(".wcwl_frontend_wrap").find(".woocommerce_waitlist.confirm").trigger("click")})}function w(){n(".wcwl_control").on("click","a.woocommerce_waitlist",function(e){e.preventDefault();var t,c=[],i=n(this).closest(".wcwl_frontend_wrap").find('input[name="wcwl_email"]');!(0<i.length)||i.val()&&(t=i.val(),/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t))?i.removeClass("wcwl_error_highlight"):(i.addClass("wcwl_error_highlight"),c.push("email"));var l=n(this).closest(".wcwl_frontend_wrap").find('input[name="wcwl_optin"]');0<l.length&&!l.is(":checked")?(l.closest(".wcwl_optin").addClass("wcwl_error_highlight"),c.push("optin")):l.closest(".wcwl_optin").removeClass("wcwl_error_highlight"),0==c.length?window.location=n(this).attr("href")+"&wcwl_email="+i.val():"email"==c[0]?i.focus():l.focus()})}n(".post-type-archive, .archive.tax-product_cat").length?e():(n(".single-product").length||n(".single-tribe_events").length)&&n(window).on("load",function(){e()})});